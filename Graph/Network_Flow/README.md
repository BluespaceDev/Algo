# 최대 플로우
방향 그래프를 "플로우 네트워크" 로 해석 가능.  

## 표현
c(u,v) : 간선의 용량  
f(u,v) : 흐르는 플로우  
s : 출발점(source)  
t : 도착점(sink)  
|f| : s에 대해 (나가는 플로우 - 들어오는 플로우), sum(f(u,v))-sum(f(v,s))  

## 플로우 네트워크
용량은 음수가 아님. c(u,v) >= 0  
간선(u,v)가 존재하면 반대 방향 간선(v,u)가 존재하지 않음.  
s->v->t 경로가 포함  
s가 아닌 각 정점은 적어도 하나의 간선을 가짐.  |E| >= |V|-1
  
## 플로우(유량) 네트워크 속성
용량 제한 속성 : f(u,v) <= c(u,v) 자명한 속성, 각 간선의 유량은 해당 간선의 용량을 초과할수 없다. 흐르는 플로우는 용량을 넘지 않음.  
플로우 보존 : Σf(u,v)=0, 정점에 들어오는 플로우 == 나가는 플로우. 나가는 플로우는 양수, 들어오는 플로우는 음수로 표현.  
플로우의 대칭성 : f(u,v) = -f(v,u). v의 입장에서는 음수의 유량을 보내는 것으로 생각.  

## 다른 문제 모델링 방법
### 역평행 간선으로 모델링
주어진 그래프가 역평행 간선(반대 방향 간선)을 가질 경우. 즉, (u,v), (v,u) 간선이 존재하는 경우.  
플로우 네트워크에서는 반대 방향 간선을 가질 수 없다.  
그래서 역평행 간선에 대해 새로운 정점 w를 추가하여 
(u,v)간선은 그대로 두고, 
(v,u)간선을 (v,w), (w,u)로 한다.  
이유는 역평행 간선을 허용하지 않는 것(플로우 네트워크의 정의)이 문제 푸는데 편리함.  
  
### 다중 출발점과 도착점을 가진 네트워크
여러개의 출발점이나 도착점, 또는 둘다 가진 경우.  
단일 출발, 도착점을 가지도록 수정하여 플로우 네트워크를 만듬.  
가상의 한 정점을 만들고, 가상의 정점과 연결하는 용량을 무한대로 설정한다. c(s,s_i) = INF  

## 푸는 방법들
1. 포드-풀커슨 방법  
2. 무방향 이분 그래프 최대 매칭  
3. 푸시-재명명 알고리즘 (빠른 알고리즘의 기초)  

## 포드-풀커슨 방법
최초로 고안된 플로우 네트워크 알고리즘

### key 아이디어
1. 잔여 네트워크 G_f  
2. 증가 경로(augmenting path)  
3. 절단  

#### 잔여 네트워크 G_f
플로우를 어떻게 직관적으로 변경할 수 있는지를 나타내는 용량을 갖는 간선들로 구성된 네트워크.  
"잔여 용량 c_f"을 갖는 간선 추가한 네트워크.  
G_f는 G에 존재하지 않는 간선들도 포함되어 있음.  (플로우 대칭성 이용)  
플로우 네트워크랑 같은 특성을 가짐.  
잔여 네트워크의 플로우 f’는 기존 플로우 네트워크에 플로우를 더하는 것에 대한 지침 제공.  
f’에 의한 플로우 증강 (f↑f’)(u,v)  
f(u,v)이면, (f↑f’)(u,v) = f(u,v)+f’(u,v)-f’(v,u)  // 상쇄f’(v,u)는 역방향 간선에 플로우를 보내는 것.  
그 외 경우, (f↑f’)(u,v) = 0  

증강 적용한 플로우는 각 플로우의 합과 같다. |f↑f’| = |f|+|f’|  
|f↑f’|는 각 간선의 용량 제한(<=c(u,v))와 플로우 보존 특성을 따른다.  

최대 플로우를 구하기 위해서는   
1. 특정 플로우를 증가하거나,  
2. 특정 플로우를 감소해야함. (반대방향)  

##### 1. 특정 플로우 증가.
흘려 보낼 수 있는 플로우를 증가시킴.  
잔여 용량 c_f(u,v) = c(u,v)-f(u,v)  // 플로우를 증가 하기 위함. 흘려 보낼 수 있는 양을 표시.  

##### 2. 특정 플로우 감소.  
반대 방향으로 플로우를 증가시킴.  
총 플로우를 증가시키기 위해 특정 간선의 플로우를 감소시켜야 할 경우가 있다.  
가능한 감소를 나타내기 위해 G_f에 잔여용량c_f(v,u) = f(u,v)를 가진 간선(v,u)  
G_f에 반대 방향으로 최대 (u,v)의 플로우를 상쇄할 수 있는 플로우를 허용하는 간선을 추가.  
간선에 따라 플로우를 되돌려보내는 것은 그 간선에서 플로우를 감소시키는 것.  
c_f(u,v) = f(v,u) // 최대(u,v) 플로우를 감소시키기 위함.  플로우 대칭성  

잔여 용량 c_f(u,v)에 대해  
f(u,v) 일때, c_f(u,v)=c(u,v)-f(u,v)  
f(v,u) 일때, c_f(u,v)=f(v,u)  
그 외 경우, c_f(u,v)=0  //c_f(u,v) = 0인 간선은 G_f에서 제외(존재하지 않음)  

예를 들어, c(u,v)=16 f(u,v)=11 이면  
c_f(u,v)=16-11=5  // 5만큼 플로우를 증가 시켜 보낼 수 있음.  
c_f(v,u)=11       // 11만큼 플로우를 감소시켜서 최대 플로우를 구할 수 있음.  

|E_f| <= 2|E|  

